# Brain Classification project
# <center> Классификация состояния человека(фокусируется, расфокус, сонность)
---
## <center> Датасет

Есть 5 участников эксперимента, которые на протяжении от 35 до 55 минут управляли поездом в программе. Во время эксперимента они были в 3-х фазах: фокусируются, расфокусируются и сонность.
Записи датчиков хранятся в 34 файлах формата .mat.

Цель проекта - определить состояния человека во время эксперимента. Такую модель можно будет использовать в выявлении качества внимания человека, на работе где это критически необходимо.
Например: водитель фуры, врач-хирург, гонщики формулы 1, и т.д.

### Baseline

В ноутбуке описаны осноные моменты проекта, и от него мы и будем отталкиваться, чтобы повысить качество модели.

#### <center> Проект включает в себя 5 разделов:

**Основные цели проекта:**
1. [Первичный анализ данных](#Первичный-анализ-данных)
2. [Статистический анализ и визуализация данных](#Статистический-анализ-данных-и-визуализация-данных)
3. [Очистка данных](#Очистка-данных) 
4. [Нормализация данных и их разметка](#Нормализация-данных-и-их-разметка)
5. [Обучение и валидация моделей](#Обучение-и-валидация-моделей)


## Первичный анализ данных
Здесь мы смотрим: 
- правильно ли загрузились наши данные
- из каких столбцов состоят данные, какого типа столбцы
- какие именно каналы используются в эксперименте

## Статистический анализ и визуализация данных
- Здесь мы посмотрели на min, mean, max для каждого канала, из-за чего появилось общее представление о том, что можно считать нормой.
- Провели визуализацию каналов на графиках в разрезе времени для каждого сигнала по всех каналам.
- Визуализировали корреляцию между используемыми каналами, заметив, что было только 2 сильно коррелирующих фактора, которые для всех экспериментов лежат в промежутке от 0.5 до 0.96 (чаще к 0.5, чем к 0.96).

Во время визуализации мы увидили общую картину, и заметили что некоторые каналы имеюют шумы, от которые можно было избавится.

## Очистка данных

Здесь мы удаляем каналы, которые можно считать нерабочими, т.к. за все время эксперимента значения не привышали отклонения в 3%.

## Нормализация данных и их разметка
Используем StandartSCaler для нормализации данных.

Проведим разметку данных, создавая новые колонки с текущим состоянием человека. 
Тут важно помнить, о совете создателя датасета: 
```
* 1st 10 minutes of data(t=0 min to t=10 min) is for "focussed" state
* 2nd 10 minutes of data(t=10 min to t=20 min) is for "unfocussed" state
* Remaining data(t=20 min to onwards) is for "Drowsed" state
```


## Обучение и валидация моделей

Тут мы строим 2 модели для предсказания состояния человека. 
    
    Первая - SVM. Вторая - LSTM, поскольку она хорошо справляется с временными рядами и может учитывать зависимость состояний во времени.

Обе модели проходят кросс-валидацию, чтобы избежать переобучения. 

## Данные

* Во вложение к проекту есть папка: data/EEG Data (из архива archive.zip), который и является исходными данными.
* В папку temp_files сохраняются промежуточные файлы.

## Выводы

Задачу предсказания состояния человека можно считать выполненной. В сравнении с baseline нам удалось получить улучшенные результаты.

## Используемые зависимости

Используйте команду: ```pip install -r requirements.txt```
    
## Использование
* Вводная описательная информация о работе представлена в jupyter-ноутбуке Baseline.ipynb.

* Все работа по улучшению Baseline, находиться в jupyter-ноутбуке prediction_of_human_condition.ipynb

* Итоговый ноутбук - LSTM_SVM.ipynb 

Для использования сервера вам нужно установить docker-compose. Посмотреть документацию можно по ссылке: https://docs.docker.com/compose/usage/

## Установка проекта + Docker
```
    docker pull artikma/brain_focus_signals:latest
    docker build -t artikma/brain_focus_signals:latest .
```
## Авторы

Мелехин Артемий